-- ========================================================
-- Populate cdm schema
-- ========================================================

insert into cdm.concept
(concept_id,concept_name,domain_id,vocabulary_id,concept_class_id,standard_concept,concept_code,valid_start_date,valid_end_date,invalid_reason)
values
    (8532,'FEMALE','Gender','Gender','Gender','S','F','1970-01-01','2099-12-31',NULL),
    (8507,'MALE','Gender','Gender','Gender','S','M','1970-01-01','2099-12-31',NULL),
    (38000276,'Problem list from EHR','Type Concept','Observation Type','Observation Type',NULL,'OMOP4822310','1970-01-01','2099-12-31',NULL),
    (8515,'Asian','Race','Race','Race','S','2','1970-01-01','2099-12-31',NULL),
    (8516,'Black or African American','Race','Race','Race','S','3','1970-01-01','2099-12-31',NULL),
    (8527,'White','Race','Race','Race','S','5','1970-01-01','2099-12-31',NULL)
;

-- These are the concepts we are looking for in the demo: - TODO - adjust some of the mock data in this script to contain these:
-- 2000006885 - Average height (VALUE_AS_NUMBER)
-- 2000000323 - MVP Age Group (VALUE_AS_STRING)
-- 2000000324 - Sex indicated by the subject (VALUE_AS_STRING)
-- 2000000280 - BMI at enrollment (VALUE_AS_NUMBER)

insert into cdm.person
(person_id,gender_concept_id,year_of_birth,month_of_birth,day_of_birth,birth_datetime,death_datetime,race_concept_id,ethnicity_concept_id,location_id,provider_id,care_site_id,person_source_value,gender_source_value,gender_source_concept_id,race_source_value,race_source_concept_id,ethnicity_source_value,ethnicity_source_concept_id)
values
    (1,8507,1981,1,26,'1981-01-26 00:00:00',NULL,8527,0,NULL,NULL,NULL,'61735069-d238-1e52-1fac-bfc49c4b6325','M',0,'white',0,'nonhispanic',0),
    (2,8507,1971,12,6,'1971-12-06 00:00:00',NULL,8527,0,NULL,NULL,NULL,'8c66bd81-9588-69bd-6f39-5acc8242bfac','M',0,'white',0,'nonhispanic',0),
    (3,8532,1942,9,26,'1942-09-26 00:00:00',NULL,8527,0,NULL,NULL,NULL,'a0ebf5bf-0009-20af-bc00-04c256717664','F',0,'white',0,'nonhispanic',0),
    (4,8532,1993,5,22,'1993-05-22 00:00:00',NULL,8516,0,NULL,NULL,NULL,'d90c07cc-e303-298a-6d28-fbac7ff3f282','F',0,'black',0,'nonhispanic',0),
    (5,8507,1953,11,11,'1953-11-11 00:00:00',NULL,8515,0,NULL,NULL,NULL,'e6b6627f-4e38-dfc8-078c-11406151c521','M',0,'asian',0,'hispanic',0)
;

insert into cdm.observation
(observation_id,person_id,observation_concept_id,observation_date,observation_datetime,observation_type_concept_id,value_as_number,value_as_string,value_as_concept_id,qualifier_concept_id,unit_concept_id,provider_id,visit_occurrence_id,visit_detail_id,observation_source_value,observation_source_concept_id,unit_source_value,qualifier_source_value,observation_event_id,obs_event_field_concept_id,value_as_datetime)
values
    (1,1,0,'2019-03-29','2019-03-29 00:00:00',38000276,NULL,NULL,0,0,0,NULL,26,0,'43878008',0,NULL,NULL,NULL,0,NULL),
    (2,1,0,'2013-04-15','2013-04-15 00:00:00',38000276,NULL,NULL,0,0,0,NULL,9,0,'422034002',0,NULL,NULL,NULL,0,NULL),
    (3,1,0,'2006-04-03','2006-04-03 00:00:00',38000276,NULL,NULL,0,0,0,NULL,33,0,'271737000',0,NULL,NULL,NULL,0,NULL),
    (4,1,0,'2012-04-09','2012-04-09 00:00:00',38000276,NULL,NULL,0,0,0,NULL,6,0,'44054006',0,NULL,NULL,NULL,0,NULL),
	(5,1,0,'2012-04-09','2012-04-09 00:00:00',38000276,NULL,NULL,0,0,0,NULL,6,0,'59621000',0,NULL,NULL,NULL,0,NULL),
	(6,1,0,'2014-04-21','2014-04-21 00:00:00',38000276,NULL,NULL,0,0,0,NULL,27,0,'237602007',0,NULL,NULL,NULL,0,NULL),
	(7,1,0,'2018-11-26','2018-11-26 00:00:00',38000276,NULL,NULL,0,0,0,NULL,4,0,'431855005',0,NULL,NULL,NULL,0,NULL),
	(8,1,0,'1987-03-01','1987-03-01 00:00:00',38000276,NULL,NULL,0,0,0,NULL,11,0,'40055000',0,NULL,NULL,NULL,0,NULL),
	(9,1,0,'2017-01-08','2017-01-08 00:00:00',38000276,NULL,NULL,0,0,0,NULL,17,0,'444814009',0,NULL,NULL,NULL,0,NULL),
	(10,1,0,'2018-11-26','2018-11-26 00:00:00',38000276,NULL,NULL,0,0,0,NULL,4,0,'127013003',0,NULL,NULL,NULL,0,NULL),
	(11,1,0,'2017-05-08','2017-05-08 00:00:00',38000276,NULL,NULL,0,0,0,NULL,10,0,'1551000119108',0,NULL,NULL,NULL,0,NULL),
	(12,1,0,'2006-04-03','2006-04-03 00:00:00',38000276,NULL,NULL,0,0,0,NULL,33,0,'15777000',0,NULL,NULL,NULL,0,NULL),
	(13,1,0,'2020-03-10','2020-03-10 00:00:00',38000276,NULL,NULL,0,0,0,NULL,38,0,'840539006',0,NULL,NULL,NULL,0,NULL),
	(14,1,0,'2020-03-10','2020-03-10 00:00:00',38000276,NULL,NULL,0,0,0,NULL,38,0,'840544004',0,NULL,NULL,NULL,0,NULL),
	(15,1,0,'2020-03-10','2020-03-10 00:00:00',38000276,NULL,NULL,0,0,0,NULL,38,0,'36955009',0,NULL,NULL,NULL,0,NULL),
	(16,1,0,'2020-03-10','2020-03-10 00:00:00',38000276,NULL,NULL,0,0,0,NULL,38,0,'386661006',0,NULL,NULL,NULL,0,NULL),
	(17,1,0,'2020-03-10','2020-03-10 00:00:00',38000276,NULL,NULL,0,0,0,NULL,38,0,'84229001',0,NULL,NULL,NULL,0,NULL),
	(18,1,0,'2020-03-10','2020-03-10 00:00:00',38000276,NULL,NULL,0,0,0,NULL,38,0,'49727002',0,NULL,NULL,NULL,0,NULL),
	(19,1,0,'2020-12-27','2020-12-27 00:00:00',38000276,NULL,NULL,0,0,0,NULL,22,0,'444814009',0,NULL,NULL,NULL,0,NULL),
	(20,1,0,'2017-06-26','2017-06-26 00:00:00',38000276,NULL,NULL,0,0,0,NULL,24,0,'65966004',0,NULL,NULL,NULL,0,NULL),
	(21,1,0,'2018-10-23','2018-10-23 00:00:00',38000276,NULL,NULL,0,0,0,NULL,23,0,'444814009',0,NULL,NULL,NULL,0,NULL),
	(22,1,0,'2013-04-15','2013-04-15 00:00:00',38000276,NULL,NULL,0,0,0,NULL,9,0,'302870006',0,NULL,NULL,NULL,0,NULL),
	(23,2,0,'2014-02-05','2014-02-05 00:00:00',38000276,NULL,NULL,0,0,0,NULL,52,0,'278860009',0,NULL,NULL,NULL,0,NULL),
	(24,2,0,'1986-01-06','1986-01-06 00:00:00',38000276,NULL,NULL,0,0,0,NULL,51,0,'162864005',0,NULL,NULL,NULL,0,NULL),
	(25,2,0,'2012-09-03','2012-09-03 00:00:00',38000276,NULL,NULL,0,0,0,NULL,40,0,'10509002',0,NULL,NULL,NULL,0,NULL),
	(26,2,0,'2020-03-11','2020-03-11 00:00:00',38000276,NULL,NULL,0,0,0,NULL,63,0,'840539006',0,NULL,NULL,NULL,0,NULL),
	(27,2,0,'2020-03-11','2020-03-11 00:00:00',38000276,NULL,NULL,0,0,0,NULL,63,0,'840544004',0,NULL,NULL,NULL,0,NULL),
	(28,2,0,'2020-03-11','2020-03-11 00:00:00',38000276,NULL,NULL,0,0,0,NULL,63,0,'386661006',0,NULL,NULL,NULL,0,NULL),
	(29,2,0,'2020-03-11','2020-03-11 00:00:00',38000276,NULL,NULL,0,0,0,NULL,63,0,'66857006',0,NULL,NULL,NULL,0,NULL),
	(30,2,0,'2020-03-11','2020-03-11 00:00:00',38000276,NULL,NULL,0,0,0,NULL,63,0,'84229001',0,NULL,NULL,NULL,0,NULL),
	(31,2,0,'2020-03-11','2020-03-11 00:00:00',38000276,NULL,NULL,0,0,0,NULL,63,0,'68235000',0,NULL,NULL,NULL,0,NULL),
	(32,2,0,'2019-12-30','2019-12-30 00:00:00',38000276,NULL,NULL,0,0,0,NULL,43,0,'271737000',0,NULL,NULL,NULL,0,NULL),
	(33,2,0,'2019-12-30','2019-12-30 00:00:00',38000276,NULL,NULL,0,0,0,NULL,43,0,'15777000',0,NULL,NULL,NULL,0,NULL),
	(34,2,0,'2019-04-22','2019-04-22 00:00:00',38000276,NULL,NULL,0,0,0,NULL,46,0,'10509002',0,NULL,NULL,NULL,0,NULL),
	(35,2,0,'2017-06-13','2017-06-13 00:00:00',38000276,NULL,NULL,0,0,0,NULL,60,0,'444814009',0,NULL,NULL,NULL,0,NULL),
	(36,3,0,'1997-06-14','1997-06-14 00:00:00',38000276,NULL,NULL,0,0,0,NULL,66,0,'22298006',0,NULL,NULL,NULL,0,NULL),
	(37,3,0,'1997-06-14','1997-06-14 00:00:00',38000276,NULL,NULL,0,0,0,NULL,66,0,'399211009',0,NULL,NULL,NULL,0,NULL),
	(38,3,0,'1985-03-09','1985-03-09 00:00:00',38000276,NULL,NULL,0,0,0,NULL,71,0,'162864005',0,NULL,NULL,NULL,0,NULL),
	(39,3,0,'1992-09-26','1992-09-26 00:00:00',38000276,NULL,NULL,0,0,0,NULL,68,0,'68496003',0,NULL,NULL,NULL,0,NULL),
	(40,3,0,'2015-05-30','2015-05-30 00:00:00',38000276,NULL,NULL,0,0,0,NULL,116,0,'195662009',0,NULL,NULL,NULL,0,NULL),
	(41,3,0,'2021-08-11','2021-08-11 00:00:00',38000276,NULL,NULL,0,0,0,NULL,69,0,'109838007',0,NULL,NULL,NULL,0,NULL),
	(42,3,0,'2016-11-02','2016-11-02 00:00:00',38000276,NULL,NULL,0,0,0,NULL,106,0,'195662009',0,NULL,NULL,NULL,0,NULL),
	(43,3,0,'2021-08-06','2021-08-06 00:00:00',38000276,NULL,NULL,0,0,0,NULL,87,0,'713197008',0,NULL,NULL,NULL,0,NULL),
	(44,3,0,'2020-04-04','2020-04-04 00:00:00',38000276,NULL,NULL,0,0,0,NULL,113,0,'68496003',0,NULL,NULL,NULL,0,NULL),
	(45,3,0,'2015-07-29','2015-07-29 00:00:00',38000276,NULL,NULL,0,0,0,NULL,88,0,'444814009',0,NULL,NULL,NULL,0,NULL),
	(46,3,0,'1973-03-31','1973-03-31 00:00:00',38000276,NULL,NULL,0,0,0,NULL,108,0,'19169002',0,NULL,NULL,NULL,0,NULL),
	(47,3,0,'1993-10-24','1993-10-24 00:00:00',38000276,NULL,NULL,0,0,0,NULL,81,0,'713197008',0,NULL,NULL,NULL,0,NULL),
	(48,3,0,'1967-12-02','1967-12-02 00:00:00',38000276,NULL,NULL,0,0,0,NULL,114,0,'53741008',0,NULL,NULL,NULL,0,NULL),
	(49,4,0,'2018-08-04','2018-08-04 00:00:00',38000276,NULL,NULL,0,0,0,NULL,140,0,'72892002',0,NULL,NULL,NULL,0,NULL),
	(50,4,0,'2020-08-12','2020-08-12 00:00:00',38000276,NULL,NULL,0,0,0,NULL,158,0,'195662009',0,NULL,NULL,NULL,0,NULL),
	(51,4,0,'2016-10-08','2016-10-08 00:00:00',38000276,NULL,NULL,0,0,0,NULL,146,0,'72892002',0,NULL,NULL,NULL,0,NULL),
	(52,4,0,'2019-08-06','2019-08-06 00:00:00',38000276,NULL,NULL,0,0,0,NULL,145,0,'62106007',0,NULL,NULL,NULL,0,NULL),
	(53,4,0,'2014-07-26','2014-07-26 00:00:00',38000276,NULL,NULL,0,0,0,NULL,155,0,'444814009',0,NULL,NULL,NULL,0,NULL),
	(54,4,0,'2020-02-10','2020-02-10 00:00:00',38000276,NULL,NULL,0,0,0,NULL,133,0,'386661006',0,NULL,NULL,NULL,0,NULL),
	(55,4,0,'2020-02-10','2020-02-10 00:00:00',38000276,NULL,NULL,0,0,0,NULL,133,0,'840539006',0,NULL,NULL,NULL,0,NULL),
	(56,4,0,'2020-02-10','2020-02-10 00:00:00',38000276,NULL,NULL,0,0,0,NULL,133,0,'840544004',0,NULL,NULL,NULL,0,NULL),
	(57,4,0,'2019-02-16','2019-02-16 00:00:00',38000276,NULL,NULL,0,0,0,NULL,162,0,'198992004',0,NULL,NULL,NULL,0,NULL),
	(58,4,0,'2012-06-06','2012-06-06 00:00:00',38000276,NULL,NULL,0,0,0,NULL,170,0,'403191005',0,NULL,NULL,NULL,0,NULL),
	(59,5,0,'2020-03-16','2020-03-16 00:00:00',38000276,NULL,NULL,0,0,0,NULL,184,0,'840539006',0,NULL,NULL,NULL,0,NULL),
	(60,5,0,'2014-01-31','2014-01-31 00:00:00',38000276,NULL,NULL,0,0,0,NULL,197,0,'1121000119107',0,NULL,NULL,NULL,0,NULL),
	(61,5,0,'2020-03-16','2020-03-16 00:00:00',38000276,NULL,NULL,0,0,0,NULL,184,0,'386661006',0,NULL,NULL,NULL,0,NULL),
	(62,5,0,'2020-03-16','2020-03-16 00:00:00',38000276,NULL,NULL,0,0,0,NULL,184,0,'840544004',0,NULL,NULL,NULL,0,NULL),
	(63,5,0,'2013-11-09','2013-11-09 00:00:00',38000276,NULL,NULL,0,0,0,NULL,188,0,'68496003',0,NULL,NULL,NULL,0,NULL),
	(64,5,0,'1993-11-17','1993-11-17 00:00:00',38000276,NULL,NULL,0,0,0,NULL,179,0,'162864005',0,NULL,NULL,NULL,0,NULL),
	(65,5,0,'2014-01-31','2014-01-31 00:00:00',38000276,NULL,NULL,0,0,0,NULL,197,0,'278860009',0,NULL,NULL,NULL,0,NULL),
	(66,5,0,'2020-03-16','2020-03-16 00:00:00',38000276,NULL,NULL,0,0,0,NULL,184,0,'84229001',0,NULL,NULL,NULL,0,NULL)
;

-- ========================================================
-- Populate results schema
-- ========================================================

insert into results.COHORT
(cohort_definition_id,subject_id)
values
-- small cohort: 1 person:
    (1,1),
-- medium cohort: 2 persons:
    (2,2),
    (2,3),
-- large cohort: 5 persons:
    (3,1),
    (3,2),
    (3,3),
    (3,4),
    (3,5)
;
